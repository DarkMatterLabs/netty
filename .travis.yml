language: java
sudo: false

before_script:
  - cp $TRAVIS_BUILD_DIR/.travis.settings.xml ~/.m2/settings.xml 

script:
  - mvn test
  - mvn package -DskipTests=true

deploy:
  provider: s3
  access_key_id: AKIAJWKQRWFHCSYGSEVA
  secret_access_key:
    secure: "TbS6w+WRhWtx4SJiSc1Av+pWscQkcQzQpMRmDtZTWipPpYV7YskjWTibpfMcNwgKy7zLeB9/AcdTbxTFzge/1RRyri1hKjlrMfra7zhnbHGIwCkr6LpB21G4wEBaE9rzArwZcHLJJvYolHWf0nTbXMCFD2IsF6wrkNzZO3n51Kig1DyAyjXvqKyH9/sgW40yeRKD6rFAxX/lBV9a2zvbwJPUyIv8RYXMxI3h6d5/J5tJbl76LBi2a9PNh+OdJRHFFe2aT/exN9PesiUBH8gvJrR/k5ZMltDt5xh9yuUiUFPvjIWGKfQAJp8WHC3E4npdwcLLc6pSg7MZsIqesGFKZz0IHMLdRiZpyFVC864cKJNtvKOJ/52ioje+gTX0LgISkvAx5Pg4+MfT1UYhQU7h3jUtKzclI7JXL0lhIeLfFLTPQJNQW28nEqPogHLSY/7IzGh0vFxtfGA25AARByyMxqUVdU9tdkj0v8ewxrDDyAh8bwP8loKhgPK/Xt2S/OcJEUFY7C4tRiwiK5OYuvDalGc1DtYsAJ1ri3h483sBu5BgPadHwLld7R8DVARGn8uyAm88jsFJT+fNWYHvsUS2JARshhoVgPYhuMJvhJzIh08m0pVs0y1dEta884uY9sfTdl7gYdVPWjmFeHv8PnUFTKqqyMmG6sq5tvtrWQLLTvw="
  bucket: keynexus-builds
  local-dir: target
  upload-dir: java/netty
  acl: private
  skip_cleanup: true
  region: us-west-2
  on:
    repo: KeyNexus/netty
    all_branches: true

# Set up notification options
notifications: 
  email:
    recipients:
      - devops@keynexus.net

    # change is when the repo status goes from pass to fail or vice versa
    on_success: change
    on_failure: always

# declare your environment variables
env:
  # global will stay the same across all matrix possibilities (will not create additional combinations to run)
  global: 
    - KN_THEME=default
    - KN_ENVIRONMENT=test
    - CC_TEST_REPORTER_ID=45c807ce000072ac08ab5da26a869f6d79f31f640d437ff7850707c76e29c771

# configure which branches to run
branches:
  except:
    - /^wip.*$/
    - /^test.*/
